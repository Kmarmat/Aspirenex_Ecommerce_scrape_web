exports.id=456,exports.ids=[456],exports.modules={5801:(e,t,r)=>{let a={"263d58ecad8fe12a1fffbd56207e22b0fddbfa14":()=>Promise.resolve().then(r.bind(r,8434)).then(e=>e.getSimilarProducts),"35dd0f32968334ac82c09e4c531bc1f3e3aeada3":()=>Promise.resolve().then(r.bind(r,8434)).then(e=>e.getProductById),b9fff2b42ae97e2f3b457f82e1464c5c6cb36c91:()=>Promise.resolve().then(r.bind(r,8434)).then(e=>e.addUserEmailToProduct),cd121b70b53ce0b37da7418eb626f8e9f8a25dbe:()=>Promise.resolve().then(r.bind(r,8434)).then(e=>e.scrapeAndStoreProduct),dabe07615237b072abc298d3ba2e005e6034e152:()=>Promise.resolve().then(r.bind(r,8434)).then(e=>e.getAllProducts),af8730b239654488ae93f9d8f12adbaf8c098a95:()=>Promise.resolve().then(r.bind(r,8888)).then(e=>e.scrapeAmazonProduct),"1a93b73d8551b5a1964f10fbacee09cf512d9d48":()=>Promise.resolve().then(r.bind(r,63)).then(e=>e.$$ACTION_0),"247d7d861bb863f45d960ac71661ff9e35c0d20d":()=>Promise.resolve().then(r.bind(r,63)).then(e=>e.generateEmailBody),"7cf04f39e5516377b0c39f6562f1950334c6d7ed":()=>Promise.resolve().then(r.bind(r,63)).then(e=>e.sendEmail)};async function c(e,...t){return(await a[e]()).apply(null,t)}e.exports={"263d58ecad8fe12a1fffbd56207e22b0fddbfa14":c.bind(null,"263d58ecad8fe12a1fffbd56207e22b0fddbfa14"),"35dd0f32968334ac82c09e4c531bc1f3e3aeada3":c.bind(null,"35dd0f32968334ac82c09e4c531bc1f3e3aeada3"),b9fff2b42ae97e2f3b457f82e1464c5c6cb36c91:c.bind(null,"b9fff2b42ae97e2f3b457f82e1464c5c6cb36c91"),cd121b70b53ce0b37da7418eb626f8e9f8a25dbe:c.bind(null,"cd121b70b53ce0b37da7418eb626f8e9f8a25dbe"),dabe07615237b072abc298d3ba2e005e6034e152:c.bind(null,"dabe07615237b072abc298d3ba2e005e6034e152"),af8730b239654488ae93f9d8f12adbaf8c098a95:c.bind(null,"af8730b239654488ae93f9d8f12adbaf8c098a95"),"1a93b73d8551b5a1964f10fbacee09cf512d9d48":c.bind(null,"1a93b73d8551b5a1964f10fbacee09cf512d9d48"),"247d7d861bb863f45d960ac71661ff9e35c0d20d":c.bind(null,"247d7d861bb863f45d960ac71661ff9e35c0d20d"),"7cf04f39e5516377b0c39f6562f1950334c6d7ed":c.bind(null,"7cf04f39e5516377b0c39f6562f1950334c6d7ed")}},1457:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},6476:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,9404,23))},6450:(e,t,r)=>{"use strict";r.d(t,{x4:()=>i,yS:()=>c}),r(5424);var a=r(6242),c=(0,a.$)("b9fff2b42ae97e2f3b457f82e1464c5c6cb36c91"),i=(0,a.$)("cd121b70b53ce0b37da7418eb626f8e9f8a25dbe");(0,a.$)("35dd0f32968334ac82c09e4c531bc1f3e3aeada3"),(0,a.$)("dabe07615237b072abc298d3ba2e005e6034e152"),(0,a.$)("263d58ecad8fe12a1fffbd56207e22b0fddbfa14")},6724:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l,metadata:()=>s});var a=r(9510),c=r(7366),i=r.n(c),n=r(7371);r(1159);var d=r(4559);let o=()=>a.jsx("header",{className:"w-full",children:a.jsx("nav",{className:"nav",children:(0,a.jsxs)(n.default,{href:"/",className:"flex items-center gap-1",children:[a.jsx(d.RMb,{fontSize:"30px"}),(0,a.jsxs)("p",{className:"nav-logo","data-aos":"fade-left",children:["Product",a.jsx("span",{className:"text-primary",children:" Explorer"})]})]})})});r(7272);let s={title:"Product Explorer",description:"Track product prices effortlessly and save money on your online shopping."};function l({children:e}){return a.jsx("html",{lang:"en",children:a.jsx("body",{className:i().className,children:(0,a.jsxs)("main",{className:"max-w-10xl mx-auto",children:[a.jsx(o,{}),e]})})})}},4359:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var a=r(9510),c=r(7710),i=r(7371);r(1159);let n=({product:e})=>(0,a.jsxs)(i.default,{href:`/products/${e._id}`,className:"product-card",children:[a.jsx("div",{className:"product-card_img-container",children:a.jsx(c.default,{src:e.image,alt:e.title,width:200,height:200,className:"product-card_img"})}),(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[a.jsx("h3",{className:"product-title",children:e.title}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("p",{className:"text-black opacity-50 text-lg capitalize",children:e.category}),(0,a.jsxs)("p",{className:"text-black text-lg font-semibold",children:[a.jsx("span",{children:e?.currency}),a.jsx("span",{children:e?.currentPrice})]})]})]})]})},8434:(e,t,r)=>{"use strict";r.r(t),r.d(t,{addUserEmailToProduct:()=>p,getAllProducts:()=>u,getProductById:()=>f,getSimilarProducts:()=>b,scrapeAndStoreProduct:()=>l});var a=r(4330);r(166);var c=r(7708),i=r(3847),n=r(3626),d=r(8888),o=r(650),s=r(63);async function l(e){if(e)try{(0,n.P)();let t=await (0,d.scrapeAmazonProduct)(e);if(!t)return;let r=t,a=await i.Z.findOne({url:t.url});if(a){let e=[...a.priceHistory,{price:t.currentPrice}];r={...t,priceHistory:e,lowestPrice:(0,o.nd)(e),highestPrice:(0,o.TF)(e),averagePrice:(0,o.bd)(e)}}let s=await i.Z.findOneAndUpdate({url:t.url},r,{upsert:!0,new:!0});(0,c.revalidatePath)(`/products/${s._id}`)}catch(e){throw Error(`Failed to create/update product: ${e.message}`)}}async function f(e){try{(0,n.P)();let t=await i.Z.findOne({_id:e});if(!t)return null;return t}catch(e){console.log(e)}}async function u(){try{return(0,n.P)(),await i.Z.find()}catch(e){console.log(e)}}async function b(e){try{if((0,n.P)(),!await i.Z.findById(e))return null;return await i.Z.find({_id:{$ne:e}}).limit(3)}catch(e){console.log(e)}}async function p(e,t){try{let r=await i.Z.findById(e);if(!r)return;if(!r.users.some(e=>e.email===t)){r.users.push({email:t}),await r.save();let e=await (0,s.generateEmailBody)(r,"WELCOME");await (0,s.sendEmail)(e,[t])}}catch(e){console.log(e)}}(0,r(618).h)([l,f,u,b,p]),(0,a.j)("cd121b70b53ce0b37da7418eb626f8e9f8a25dbe",l),(0,a.j)("35dd0f32968334ac82c09e4c531bc1f3e3aeada3",f),(0,a.j)("dabe07615237b072abc298d3ba2e005e6034e152",u),(0,a.j)("263d58ecad8fe12a1fffbd56207e22b0fddbfa14",b),(0,a.j)("b9fff2b42ae97e2f3b457f82e1464c5c6cb36c91",p)},3847:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var a=r(1185),c=r.n(a);let i=new(c()).Schema({url:{type:String,required:!0,unique:!0},currency:{type:String,required:!0},image:{type:String,required:!0},title:{type:String,required:!0},currentPrice:{type:Number,required:!0},originalPrice:{type:Number,required:!0},priceHistory:[{price:{type:Number,required:!0},date:{type:Date,default:Date.now}}],lowestPrice:{type:Number},highestPrice:{type:Number},averagePrice:{type:Number},discountRate:{type:Number},description:{type:String},category:{type:String},reviewsCount:{type:Number},isOutOfStock:{type:Boolean,default:!1},users:[{email:{type:String,required:!0}}],default:[]},{timestamps:!0}),n=c().models.Product||c().model("Product",i)},3626:(e,t,r)=>{"use strict";r.d(t,{P:()=>n});var a=r(1185),c=r.n(a);let i=!1,n=async()=>{if(c().set("strictQuery",!0),!process.env.MONGODB_URI)return console.log("MONGODB_URI is not defined");if(i)return console.log("=> using existing database connection");try{await c().connect(process.env.MONGODB_URI),i=!0,console.log("MongoDB Connected")}catch(e){console.log(e)}}},63:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$ACTION_0:()=>l,generateEmailBody:()=>d,sendEmail:()=>s});var a=r(4330);r(166);var c=r(5245),i=r(618);let n={WELCOME:"WELCOME",CHANGE_OF_STOCK:"CHANGE_OF_STOCK",LOWEST_PRICE:"LOWEST_PRICE",THRESHOLD_MET:"THRESHOLD_MET"};async function d(e,t){let r=e.title.length>20?`${e.title.substring(0,20)}...`:e.title,a="",c="";switch(t){case n.WELCOME:a=`Welcome to Product price Tracking for ${r}`,c=`
        <div>
          <h2>Welcome to Product Explorer ðŸš€</h2>
          <p>You are now tracking ${e.title}.</p>
          <p>Here's an example of how you'll receive updates:</p>
          <div style="border: 1px solid #ccc; padding: 10px; background-color: #f8f8f8;">
            <h3>${e.title} is back in stock!</h3>
            <p>We're excited to let you know that ${e.title} is now back in stock.</p>
            <p>Don't miss out - <a href="${e.url}" target="_blank" rel="noopener noreferrer">buy it now</a>!</p>
            <img src="https://i.ibb.co/pwFBRMC/Screenshot-2023-09-26-at-1-47-50-AM.png" alt="Product Image" style="max-width: 100%;" />
          </div>
          <p>Stay tuned for more updates on ${e.title} and other products you're tracking.</p>
        </div>
      `;break;case n.CHANGE_OF_STOCK:a=`${r} is now back in stock!`,c=`
        <div>
          <h4>Hey, ${e.title} is now restocked! Grab yours before they run out again!</h4>
          <p>See the product <a href="${e.url}" target="_blank" rel="noopener noreferrer">here</a>.</p>
        </div>
      `;break;case n.LOWEST_PRICE:a=`Lowest Price Alert for ${r}`,c=`
        <div>
          <h4>Hey, ${e.title} has reached its lowest price ever!!</h4>
          <p>Grab the product <a href="${e.url}" target="_blank" rel="noopener noreferrer">here</a> now.</p>
        </div>
      `;break;case n.THRESHOLD_MET:a=`Discount Alert for ${r}`,c=`
        <div>
          <h4>Hey, ${e.title} is now available at a discount more than 40%!</h4>
          <p>Grab it right away from <a href="${e.url}" target="_blank" rel="noopener noreferrer">here</a>.</p>
        </div>
      `;break;default:throw Error("Invalid notification type.")}return{subject:a,body:c}}let o=c.createTransport({pool:!0,service:"hotmail",port:2525,auth:{user:"kunalmarmat2002@outlook.com",pass:process.env.EMAIL_PASSWORD},maxConnections:1}),s=(0,a.j)("1a93b73d8551b5a1964f10fbacee09cf512d9d48",l);async function l(e,t){let r={from:"kunalmarmat2002@outlook.com",to:t,html:e.body,subject:e.subject};o.sendMail(r,(e,t)=>{if(e)return console.log(e);console.log("Email sent: ",t)})}(0,i.h)([d,s]),(0,a.j)("247d7d861bb863f45d960ac71661ff9e35c0d20d",d),(0,a.j)("7cf04f39e5516377b0c39f6562f1950334c6d7ed",s)},8888:(e,t,r)=>{"use strict";r.r(t),r.d(t,{scrapeAmazonProduct:()=>d});var a=r(4330);r(166);var c=r(8198),i=r(7179),n=r(650);async function d(e){if(!e)return;let t=String(process.env.BRIGHT_DATA_USERNAME),r={auth:{username:`${t}-session-${1e6*Math.random()|0}`,password:String(process.env.BRIGHT_DATA_PASSWORD)},host:"brd.superproxy.io",port:22225,rejectUnauthorized:!1};try{let t=await c.Z.get(e,r),a=i.zD(t.data),d=a("#productTitle").text().trim(),o=(0,n.EL)(a(".priceToPay span.a-price-whole"),a(".a.size.base.a-color-price"),a(".a-button-selected .a-color-base")),s=(0,n.EL)(a("#priceblock_ourprice"),a(".a-price.a-text-price span.a-offscreen"),a("#listPrice"),a("#priceblock_dealprice"),a(".a-size-base.a-color-price")),l="currently unavailable"===a("#availability span").text().trim().toLowerCase(),f=a("#imgBlkFront").attr("data-a-dynamic-image")||a("#landingImage").attr("data-a-dynamic-image")||"{}",u=Object.keys(JSON.parse(f)),b=(0,n.Eq)(a(".a-price-symbol")),p=a(".savingsPercentage").text().replace(/[-%]/g,""),m=(0,n.B0)(a);return{url:e,currency:b||"$",image:u[0],title:d,currentPrice:Number(o)||Number(s),originalPrice:Number(s)||Number(o),priceHistory:[],discountRate:Number(p),category:"category",reviewsCount:100,stars:4.5,isOutOfStock:l,description:m,lowestPrice:Number(o)||Number(s),highestPrice:Number(s)||Number(o),averagePrice:Number(o)||Number(s)}}catch(e){console.log(e)}}(0,r(618).h)([d]),(0,a.j)("af8730b239654488ae93f9d8f12adbaf8c098a95",d)},650:(e,t,r)=>{"use strict";r.d(t,{B0:()=>n,EL:()=>c,Eq:()=>i,TF:()=>d,Ux:()=>l,bd:()=>s,nd:()=>o,uf:()=>f});let a={CHANGE_OF_STOCK:"CHANGE_OF_STOCK",LOWEST_PRICE:"LOWEST_PRICE",THRESHOLD_MET:"THRESHOLD_MET"};function c(...e){for(let t of e){let e=t.text().trim();if(e){let t;let r=e.replace(/[^\d.]/g,"");return r&&(t=r.match(/\d+\.\d{2}/)?.[0]),t||r}}return""}function i(e){return e.text().trim().slice(0,1)||""}function n(e){for(let t of[".a-unordered-list .a-list-item",".a-expander-content p"]){let r=e(t);if(r.length>0)return r.map((t,r)=>e(r).text().trim()).get().join("\n")}return""}function d(e){let t=e[0];for(let r=0;r<e.length;r++)e[r].price>t.price&&(t=e[r]);return t.price}function o(e){let t=e[0];for(let r=0;r<e.length;r++)e[r].price<t.price&&(t=e[r]);return t.price}function s(e){return e.reduce((e,t)=>e+t.price,0)/e.length||0}let l=(e,t)=>{let r=o(t.priceHistory);return e.currentPrice<r?a.LOWEST_PRICE:!e.isOutOfStock&&t.isOutOfStock?a.CHANGE_OF_STOCK:e.discountRate>=40?a.THRESHOLD_MET:null},f=(e=0)=>e.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})},7481:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var a=r(6621);let c=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},7272:()=>{}};